<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZK-PRET Refactored - Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles-refactored.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">ZK-PRET Refactored</h1>
                        <p class="text-sm text-gray-500">Clean Architecture Test</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <!-- Mode Toggle -->
                    <div class="flex items-center space-x-3">
                        <span class="text-sm font-medium text-gray-600">Sync</span>
                        <label class="mode-toggle">
                            <input type="checkbox" id="async-mode-toggle" checked>
                            <span class="slider"></span>
                        </label>
                        <span class="text-sm font-medium text-gray-600">Async</span>
                    </div>
                    
                    <!-- Job Queue Indicator -->
                    <div id="job-queue-indicator" class="hidden flex items-center space-x-2 bg-blue-50 px-3 py-1 rounded-full border border-blue-200">
                        <div class="w-2 h-2 bg-blue-500 rounded-full pulse-dot"></div>
                        <span class="text-sm font-medium text-blue-700">
                            <span id="running-jobs-count">0</span> jobs running
                        </span>
                    </div>
                    
                    <!-- Connection Status -->
                    <div id="connection-status" class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-gray-400 rounded-full"></div>
                        <span class="text-sm text-gray-600">Testing...</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <div id="notifications" class="fixed top-4 right-4 z-50"></div>
        
        <!-- Tab Navigation -->
        <div class="mb-8">
            <nav class="flex space-x-1 bg-white rounded-lg p-1 shadow-sm">
                <button class="tab-btn active flex-1 px-6 py-3 text-sm font-medium rounded-md" data-tab="compliance">
                    <i class="fas fa-shield-alt mr-2"></i>Compliance Prover
                </button>
                <button class="tab-btn flex-1 px-6 py-3 text-sm font-medium rounded-md" data-tab="gleif">
                    <i class="fas fa-building mr-2"></i>GLEIF Verification
                </button>
                <button class="tab-btn flex-1 px-6 py-3 text-sm font-medium rounded-md" data-tab="corporate">
                    <i class="fas fa-certificate mr-2"></i>Corporate Registration
                </button>
            </nav>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Main Content -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-lg shadow-sm border">
                    <!-- Compliance Tab -->
                    <div id="compliance-tab" class="tab-content p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-shield-alt mr-2 text-blue-600"></i>
                            Compliance Prover - Test Interface
                        </h3>
                        <div class="space-y-6">
                            <div class="text-gray-600 mb-6">
                                <p class="leading-relaxed">This is the refactored ZK-PRET application with clean, modular architecture. Click the buttons below to test the new system.</p>
                            </div>
                            
                            <div class="grid md:grid-cols-2 gap-4">
                                <button id="test-notification-btn" class="btn btn-primary">
                                    <i class="fas fa-bell mr-2"></i>Test Notification
                                </button>
                                <button id="test-gleif-btn" class="btn btn-primary">
                                    <i class="fas fa-building mr-2"></i>Test GLEIF
                                </button>
                                <button id="test-error-btn" class="btn btn-secondary">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>Test Error
                                </button>
                                <button id="test-connection-btn" class="btn btn-secondary">
                                    <i class="fas fa-wifi mr-2"></i>Test Connection
                                </button>
                            </div>
                            
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-start">
                                    <i class="fas fa-info-circle text-blue-600 mt-0.5 mr-3"></i>
                                    <div class="text-sm text-blue-700">
                                        <p class="font-medium mb-1">Refactored Architecture Benefits</p>
                                        <ul class="list-disc list-inside space-y-1">
                                            <li>Modular components with clear separation of concerns</li>
                                            <li>Clean API client with centralized error handling</li>
                                            <li>Reusable notification system</li>
                                            <li>File management utilities</li>
                                            <li>Async job queue management</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- GLEIF Tab -->
                    <div id="gleif-tab" class="tab-content hidden p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-building mr-2 text-blue-600"></i>
                            GLEIF Entity Verification
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <strong>Company Name</strong>
                                </label>
                                <input type="text" id="company-name-input" class="form-input" placeholder="Enter company name" value="SREE PALANI ANDAVAR AGROS PRIVATE LIMITED">
                            </div>
                            
                            <button id="gleif-execute-btn" class="btn btn-primary w-full">
                                <i class="fas fa-play mr-2"></i>
                                Generate GLEIF ZK Proof
                            </button>
                        </div>
                    </div>

                    <!-- Corporate Tab -->
                    <div id="corporate-tab" class="tab-content hidden p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-certificate mr-2 text-green-600"></i>
                            Corporate Registration Verification
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <strong>Corporate Identification Number (CIN)</strong>
                                </label>
                                <input type="text" id="cin-input" class="form-input" placeholder="Enter CIN">
                            </div>
                            
                            <button id="corporate-execute-btn" class="btn btn-primary w-full">
                                <i class="fas fa-play mr-2"></i>
                                Generate Corporate Registration ZK Proof
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Server Status -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-server mr-2 text-green-600"></i>
                        Server Status
                    </h3>
                    <div id="server-status">
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Status:</span>
                                <span class="font-medium text-green-600">Testing</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ZK-PRET Server:</span>
                                <span class="text-yellow-600">Simulated</span>
                            </div>
                            <div class="text-xs text-gray-500">
                                Last updated: Just now
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Job Queue -->
                <div id="job-queue-panel" class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center justify-between">
                        <span>
                            <i class="fas fa-tasks mr-2 text-blue-600"></i>
                            Job Queue
                        </span>
                        <button id="clear-completed-jobs" class="text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded hover:bg-gray-100 transition-colors">
                            Clear completed
                        </button>
                    </h3>
                    <div id="job-queue-list" class="space-y-2">
                        <div class="text-center py-6 text-gray-500">
                            <i class="fas fa-clock text-2xl mb-2 opacity-50"></i>
                            <p class="text-sm">No jobs in queue</p>
                        </div>
                    </div>
                </div>

                <!-- Execution Results -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-clipboard-list mr-2 text-purple-600"></i>
                        Execution Results
                    </h3>
                    <div id="execution-results" class="results-container">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-play-circle text-4xl mb-4 opacity-50"></i>
                            <p>No executions yet</p>
                            <p class="text-sm">Test the refactored components above</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Load the refactored JavaScript -->
    <script src="js/app-refactored.js"></script>
    
    <!-- Test Scripts -->
    <script>
        // Wait for the app to initialize, then add test functionality
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (window.zkpretApp) {
                    console.log('✅ ZK-PRET Refactored App loaded successfully');
                    
                    // Add test button handlers
                    document.getElementById('test-notification-btn').addEventListener('click', () => {
                        window.zkpretApp.notifications.success('Test Success', 'Notification system is working perfectly!');
                    });
                    
                    document.getElementById('test-gleif-btn').addEventListener('click', () => {
                        window.zkpretApp.switchTab('gleif');
                        window.zkpretApp.notifications.info('Tab Switched', 'Switched to GLEIF verification tab');
                    });
                    
                    document.getElementById('test-error-btn').addEventListener('click', () => {
                        window.zkpretApp.notifications.error('Test Error', 'This is a simulated error message');
                    });
                    
                    document.getElementById('test-connection-btn').addEventListener('click', () => {
                        window.zkpretApp.notifications.warning('Test Warning', 'Connection test simulated');
                        window.zkpretApp.updateConnectionStatus(Math.random() > 0.5);
                    });
                    
                } else {
                    console.error('❌ ZK-PRET Refactored App failed to load');
                }
            }, 100);
        });
    </script>
</body>
</html>